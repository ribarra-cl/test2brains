!function(e){function t(t){for(var r,i,u=t[0],s=t[1],c=t[2],p=0,f=[];p<u.length;p++)i=u[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);f.length;)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,u=1;u<n.length;u++){var s=n[u];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={0:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=s;a.push([42,1]),n()}({1:function(e,t){e.exports=React},18:function(e,t){e.exports=ReactDOM},20:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOGIN_SETUP_TOKEN="/LOGIN/SETUP_TOKEN",t.LOGIN_CLEAR="/LOGIN/CLEAR",t.loginSetupTokenAction=function(e){return{type:t.LOGIN_SETUP_TOKEN,payload:{token:e}}},t.loginClearAction=function(){return{type:t.LOGIN_CLEAR}}},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(66);t.get=function(e){return r.default.get(e,{headers:{"Content-Type":"application/json"}})},t.post=function(e){return r.default.post("/api/users/login",e,{headers:{"Content-Type":"application/json"}})}},27:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILE_LOAD="/PROFILE/LOAD",t.loadProfileDataAction=function(e){return{type:t.PROFILE_LOAD,payload:{user:e}}}},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.humanizeName=function(e){return e.name.title+" "+e.name.first+" "+e.name.last}},42:function(e,t,n){n(43),e.exports=n(44)},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(18),a=n(15),i=n(49),u=n(59),s=n(62),c=n(63),l=n(10),p=n(88),f=n(84),d=n(85);t.firebaseApp=i.initializeApp(s.default);var m={key:"root",storage:d.default},v=p.persistReducer(m,u.default),h=l.createStore(v),g=p.persistStore(h);o.render(r.createElement(a.Provider,{store:h},r.createElement(f.PersistGate,{persistor:g},r.createElement(c.default,null))),document.getElementById("app"))},59:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=n(60),a=n(61),i=r.combineReducers({login:a.default,profile:o.default});t.default=i},60:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),a={user:{name:{title:"",first:"",last:""},login:{uuid:"",username:""},picture:{large:"",medium:"",thumbnail:""},email:""}};t.default=function(e,t){switch(void 0===e&&(e=a),t.type){case o.PROFILE_LOAD:return r(r({},e),{user:t.payload.user});default:return e}}},61:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(20),a={token:""};t.default=function(e,t){switch(void 0===e&&(e=a),t.type){case o.LOGIN_SETUP_TOKEN:return r(r({},e),{token:t.payload.token});case o.LOGIN_CLEAR:return r(r({},e),{token:""});default:return e}}},62:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={apiKey:"AIzaSyAZ6x5IIxsrn2IhzkcjiXQss4o7ika8zwU",authDomain:"localhost:3000",databaseURL:"https://brains-78452.firebaseio.com",projectId:"brains-78452",storageBucket:"brains-78452.appspot.com",messagingSenderId:"570422194655",appId:"1:570422194655:web:58681ac1f4d23abafe546a",measurementId:"G-H8W77204FP"}},63:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=n(28);n(29);var u=n(22),s=n(65),c=n(83),l=n(21),p=n(15),f=n(20),d=n(38),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentDidMount=function(){t.unsubscribe=i.auth().onAuthStateChanged((function(e){console.log("--user",e),e?l.get("/api/users/"+e.uid).then((function(e){console.log(e.data),t.setState({loading:!1,user:e.data}),t.unsubscribe()})).catch((function(e){console.log(e)})):(t.setState({loading:!1}),console.log("--no user"))}))},t.onLogout=function(){i.auth().signOut(),t.props.dispatch(f.loginClearAction())},t.render=function(){var e=t.props,n=e.login,r=e.profile;return a.createElement(u.BrowserRouter,null,a.createElement("nav",{className:"navbar navbar-expand-sm bg-dark navbar-dark"},a.createElement("div",{className:"navbar-collapse collapse"},a.createElement("ul",{className:"navbar-nav mr-auto"},a.createElement("li",null,a.createElement("span",null,"Hola ",n.token?d.humanizeName(r.user):""))),n.token?a.createElement("ul",{className:"navbar-nav ml-auto"},a.createElement("li",null,a.createElement("a",{href:"#",onClick:t.onLogout},"Cerrar sesión"))):null)),a.createElement("div",null,a.createElement(u.Switch,null,a.createElement(u.Route,{exact:!0,path:"/",component:s.default}),a.createElement(u.Route,{path:"/users/",component:c.default}))))},t}return o(t,e),t.defaultProps={login:{token:""},profile:{user:{name:{title:"",first:"",last:""},login:{uuid:"",username:""},picture:{large:"",medium:"",thumbnail:""},email:""}}},t}(a.Component);t.default=p.connect((function(e){return{login:e.login,profile:e.profile}}),(function(e){return{dispatch:e}}))(m)},65:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=n(28);n(29);var u=n(21),s=n(22),c=n(15),l=n(27),p=n(20),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loading:!1,error:"",username:"",password:""},t.componentDidMount=function(){t.setState({loading:!0})},t.componentDidUpdate=function(e,n,r){var o=t.props.login;console.log("prev",e.login.token),o.token&&(console.log("--token",o.token),t.props.history.push("/users"))},t.onChange=function(e){var n=e.target.name;"username"==n&&t.setState({username:e.target.value}),"password"==n&&t.setState({password:e.target.value})},t.onSubmit=function(e){u.post(t.state).then((function(e){var t=e.data,n=t.error,r=t.token;if(n)throw new Error("Usuario o contraseña incorrecta");return i.auth().signInWithCustomToken(r)})).then((function(e){var t=e.user.uid;return u.get("/api/users/"+t)})).then((function(e){t.props.dispatch(p.loginSetupTokenAction(e.data.id.value)),t.props.dispatch(l.loadProfileDataAction(e.data)),console.log("-- second response",e.data)})).catch((function(e){alert(e)})),e.preventDefault()},t.render=function(){return a.createElement("div",null,a.createElement("div",{className:"container"},a.createElement("div",{className:"row justify-content-center"},a.createElement("div",{className:"col-sm-auto"},a.createElement("form",{method:"POST",onSubmit:t.onSubmit},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"username"},"Nombre de usuario"),a.createElement("input",{type:"text",name:"username",className:"form-control",id:"username",value:t.state.username,onChange:t.onChange})),a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"password"},"Contraseña"),a.createElement("input",{type:"password",name:"password",className:"form-control",id:"password",value:t.state.password,onChange:t.onChange}),a.createElement("div",{className:"invalid-feedback"},"Please provide a valid city.")),a.createElement("button",{type:"submit",className:"btn btn-primary"},"Ingresar"))))))},t}return o(t,e),t}(a.Component);t.default=s.withRouter(c.connect((function(e){return{login:e.login,profile:e.profile}}))(f))},83:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=n(38),u=n(22),s=n(15),c=n(21),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loggedIn:!1,loading:!1,users:[]},t.componentDidMount=function(){if(!t.props.login.token)return t.props.history.push("/");c.get("/api/users/").then((function(e){var n=e.data;t.setState({users:n,loading:!1})})).catch((function(e){console.log("--error",e)}))},t.componentDidUpdate=function(e,n,r){var o=t.props.login;console.log("prev",e.login.token),o.token||t.props.history.push("/")},t.render=function(){var e=t.state,n=(e.loggedIn,e.loading,e.users);return a.createElement("div",{className:"container"},a.createElement("div",{className:"row"},n.map((function(e){return a.createElement("div",{key:"user-"+e.login.uuid,className:"col-sm-4"},a.createElement("div",{className:"card"},a.createElement("div",{className:"card-body"},a.createElement("img",{src:e.picture.large,className:"card-img-top"}),a.createElement("div",{className:"card-body"},a.createElement("h5",{className:"card-title"},i.humanizeName(e)),a.createElement("p",{className:"card-text"},e.email)))))}))))},t}return o(t,e),t}(a.Component);t.default=u.withRouter(s.connect((function(e){return{login:e.login,profile:e.profile}}))(l))}});
//# sourceMappingURL=main.bundle.js.map