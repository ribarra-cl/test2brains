!function(e){function t(t){for(var r,i,s=t[0],u=t[1],l=t[2],p=0,f=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(c&&c(t);f.length;)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={0:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var c=u;a.push([36,1]),n()}({0:function(e,t){e.exports=React},13:function(e,t){e.exports=ReactDOM},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOGIN_SETUP_TOKEN="/LOGIN/SETUP_TOKEN",t.LOGIN_CLEAR="/LOGIN/CLEAR",t.loginSetupTokenAction=function(e){return{type:t.LOGIN_SETUP_TOKEN,payload:{token:e}}},t.loginClearAction=function(){return{type:t.LOGIN_CLEAR}}},18:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53);t.get=function(e){return r.default.get(e,{headers:{"Content-Type":"application/json"}})},t.post=function(e){return r.default.post("/api/users/login",e,{headers:{"Content-Type":"application/json"}})}},24:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILE_LOAD="/PROFILE/LOAD",t.loadProfileDataAction=function(e){return{type:t.PROFILE_LOAD,payload:{user:e}}}},33:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.humanizeName=function(e){return e.name.title+" "+e.name.first+" "+e.name.last}},36:function(e,t,n){n(37),e.exports=n(38)},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(13),a=n(10),i=n(14);n(16);var s=n(46),u=n(49),l=n(50),c=n(7),p=n(76),f=n(72),d=n(73);t.firebaseApp=i.default.initializeApp(u.default);var m={key:"root",storage:d.default},v=p.persistReducer(m,s.default),h=c.createStore(v),g=p.persistStore(h);o.render(r.createElement(a.Provider,{store:h},r.createElement(f.PersistGate,{persistor:g},r.createElement(l.default,null))),document.getElementById("app"))},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(47),a=n(48),i=r.combineReducers({login:a.default,profile:o.default});t.default=i},47:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),a={user:{name:{title:"",first:"",last:""},login:{uuid:"",username:""},picture:{large:"",medium:"",thumbnail:""},email:""}};t.default=function(e,t){switch(void 0===e&&(e=a),t.type){case o.PROFILE_LOAD:return r(r({},e),{user:t.payload.user});default:return e}}},48:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),a={token:""};t.default=function(e,t){switch(void 0===e&&(e=a),t.type){case o.LOGIN_SETUP_TOKEN:return r(r({},e),{token:t.payload.token});case o.LOGIN_CLEAR:return r(r({},e),{token:""});default:return e}}},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={apiKey:"AIzaSyAZ6x5IIxsrn2IhzkcjiXQss4o7ika8zwU",authDomain:"localhost:3000",databaseURL:"https://brains-78452.firebaseio.com",projectId:"brains-78452",storageBucket:"brains-78452.appspot.com",messagingSenderId:"570422194655",appId:"1:570422194655:web:58681ac1f4d23abafe546a",measurementId:"G-H8W77204FP"}},50:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(14);n(16);var s=n(19),u=n(52),l=n(71),c=n(18),p=n(10),f=n(17),d=n(33),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentDidMount=function(){t.unsubscribe=i.auth().onAuthStateChanged((function(e){console.log("--user",e),e?c.get("/api/users/"+e.uid).then((function(e){console.log(e.data),t.setState({loading:!1,user:e.data}),t.unsubscribe()})).catch((function(e){console.log(e)})):(t.setState({loading:!1}),console.log("--no user"))}))},t.onLogout=function(){i.auth().signOut(),t.props.dispatch(f.loginClearAction())},t.render=function(){var e=t.props,n=e.login,r=e.profile;return a.createElement(s.BrowserRouter,null,a.createElement("nav",{className:"navbar navbar-expand-sm bg-dark navbar-dark"},a.createElement("div",{className:"navbar-collapse collapse"},a.createElement("ul",{className:"navbar-nav mr-auto"},a.createElement("li",null,a.createElement("span",null,"Hola ",n.token?d.humanizeName(r.user):""))),n.token?a.createElement("ul",{className:"navbar-nav ml-auto"},a.createElement("li",null,a.createElement("a",{href:"#",onClick:t.onLogout},"Cerrar sesión"))):null)),a.createElement("div",null,a.createElement(s.Switch,null,a.createElement(s.Route,{exact:!0,path:"/",component:u.default}),a.createElement(s.Route,{path:"/users/",component:l.default}))))},t}return o(t,e),t.defaultProps={login:{token:""},profile:{user:{name:{title:"",first:"",last:""},login:{uuid:"",username:""},picture:{large:"",medium:"",thumbnail:""},email:""}}},t}(a.Component);t.default=p.connect((function(e){return{login:e.login,profile:e.profile}}),(function(e){return{dispatch:e}}))(m)},52:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(14);n(16);var s=n(18),u=n(19),l=n(10),c=n(24),p=n(17),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loading:!1,error:"",username:"",password:""},t.componentDidUpdate=function(e,n,r){var o=t.props.login;console.log("prev",e.login.token),o.token&&(console.log("--token",o.token),t.props.history.push("/users"))},t.onChange=function(e){var n=e.target.name;"username"==n&&t.setState({username:e.target.value}),"password"==n&&t.setState({password:e.target.value})},t.onSubmit=function(e){t.setState({error:"",loading:!0}),s.post(t.state).then((function(e){var t=e.data,n=t.error,r=t.token;if(n)throw new Error("Usuario o contraseña incorrecta");return i.auth().signInWithCustomToken(r)})).then((function(e){var t=e.user.uid;return s.get("/api/users/"+t)})).then((function(e){t.props.dispatch(p.loginSetupTokenAction(e.data.id.value)),t.props.dispatch(c.loadProfileDataAction(e.data)),console.log("-- second response",e.data)})).catch((function(e){t.setState({loading:!1,error:e.message})})),e.preventDefault()},t.render=function(){var e=t.state,n=e.error,r=e.loading;return a.createElement("div",null,a.createElement("div",{className:"container"},a.createElement("div",{className:"row justify-content-center"},a.createElement("div",{className:"col-md-auto"},a.createElement("form",{method:"POST",onSubmit:t.onSubmit},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"username"},"Nombre de usuario"),a.createElement("input",{type:"text",name:"username",className:"form-control",id:"username",value:t.state.username,onChange:t.onChange})),a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"password"},"Contraseña"),a.createElement("input",{type:"password",name:"password",className:n?"form-control is-invalid":"form-control",id:"password",value:t.state.password,onChange:t.onChange}),n?a.createElement("div",{className:"invalid-feedback"},n):null),r?a.createElement("button",{type:"submit",className:"btn btn-primary"},a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})," Cargando..."):a.createElement("button",{type:"submit",className:"btn btn-primary"},"Ingresar"))))))},t}return o(t,e),t}(a.Component);t.default=u.withRouter(l.connect((function(e){return{login:e.login,profile:e.profile}}))(f))},71:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(33),s=n(19),u=n(10),l=n(18),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loggedIn:!1,loading:!1,users:[]},t.componentDidMount=function(){if(!t.props.login.token)return t.props.history.push("/");l.get("/api/users/").then((function(e){var n=e.data;t.setState({users:n,loading:!1})})).catch((function(e){console.log("--error",e)}))},t.componentDidUpdate=function(e,n,r){var o=t.props.login;console.log("prev",e.login.token),o.token||t.props.history.push("/")},t.render=function(){var e=t.state,n=(e.loggedIn,e.loading,e.users);return a.createElement("div",{className:"container"},a.createElement("div",{className:"row"},n.map((function(e){return a.createElement("div",{key:"user-"+e.login.uuid,className:"col-sm-4"},a.createElement("div",{className:"card"},a.createElement("div",{className:"card-body"},a.createElement("img",{src:e.picture.large,className:"card-img-top"}),a.createElement("div",{className:"card-body"},a.createElement("h5",{className:"card-title"},i.humanizeName(e)),a.createElement("p",{className:"card-text"},e.email)))))}))))},t}return o(t,e),t}(a.Component);t.default=s.withRouter(u.connect((function(e){return{login:e.login,profile:e.profile}}))(c))}});
//# sourceMappingURL=main.bundle.js.map